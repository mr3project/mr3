diff --git a/hadoop/conf/local/hive-site.xml b/hadoop/conf/local/hive-site.xml
index 797c3dc..594dc07 100644
--- a/hadoop/conf/local/hive-site.xml
+++ b/hadoop/conf/local/hive-site.xml
@@ -184,6 +184,11 @@
   <value>true</value>
 </property>
 
+<property>
+  <name>hive.optimize.index.filter</name>
+  <value>true</value>
+</property>
+
 <property>
   <name>hive.optimize.metadataonly</name>
   <value>true</value>
@@ -209,6 +214,11 @@
   <value>binary</value>
 </property>
 
+<property>
+  <name>hive.stats.fetch.column.stats</name>
+  <value>true</value>
+</property>
+
 <property>
   <name>hive.support.concurrency</name>
   <value>true</value>
@@ -219,6 +229,11 @@
   <value>true</value>
 </property>
 
+<property>
+  <name>hive.tez.bucket.pruning</name>
+  <value>true</value>
+</property>
+
 <property>
   <name>hive.txn.manager</name>
   <value>org.apache.hadoop.hive.ql.lockmgr.DbTxnManager</value>
@@ -246,31 +261,6 @@
 
 <!-- Correctness -->
 
-<property>
-  <name>hive.optimize.shared.work.dppunion</name>
-  <value>false</value>
-</property>
-
-<property>
-  <name>hive.optimize.shared.work.dppunion.merge.eventops</name>
-  <value>false</value>
-</property>
-
-<property>
-  <name>hive.optimize.shared.work.downstream.merge</name>
-  <value>false</value>
-</property>
-
-<property>
-  <name>hive.optimize.shared.work.parallel.edge.support</name>
-  <value>false</value>
-</property>
-
-<property>
-  <name>hive.optimize.shared.work.merge.ts.schema</name>
-  <value>false</value>
-</property>
-
 <property>
   <name>hive.optimize.cte.materialize.threshold</name>
   <value>-1</value>
@@ -366,11 +356,6 @@
   <value>10</value>
 </property>
 
-<property>
-  <name>hive.llap.io.etl.skip.format</name>
-  <value>none</value>
-</property>
-
 <!-- MR3 -->
 
 <property>
@@ -395,7 +380,7 @@
 
 <property>
   <name>hive.mr3.aux.jars</name>
-  <value>hive-llap-common-4.0.0.jar,hive-llap-server-4.0.0.jar,hive-llap-tez-4.0.0.jar,hive-iceberg-handler-4.0.0.jar,log4j-1.2-api-2.18.0.jar,orc-core-2.0.3.jar,orc-format-1.0.0.jar,orc-shims-2.0.3.jar,orc-tools-2.0.3.jar</value>
+  <value>hive-llap-common-3.1.3.jar,hive-llap-server-3.1.3.jar,hive-llap-tez-3.1.3.jar</value>
 </property>
 
 <property>
diff --git a/hadoop/conf/tpcds/hive-site.xml b/hadoop/conf/tpcds/hive-site.xml
index 00711ea..23e07da 100644
--- a/hadoop/conf/tpcds/hive-site.xml
+++ b/hadoop/conf/tpcds/hive-site.xml
@@ -84,11 +84,6 @@
   <value>true</value>
 </property>
 
-<property>
-  <name>hive.compactor.cleaner.on</name>
-  <value>false</value>
-</property>
-
 <property>
   <name>hive.compactor.initiator.on</name>
   <value>false</value>
@@ -238,11 +233,21 @@
   <value>true</value>
 </property>
 
+<property>
+  <name>hive.optimize.index.filter</name>
+  <value>true</value>
+</property>
+
 <property>
   <name>hive.optimize.metadataonly</name>
   <value>true</value>
 </property>
 
+<property>
+  <name>hive.optimize.sort.dynamic.partition</name>
+  <value>true</value>
+</property>
+
 <property>
   <name>hive.orc.cache.stripe.details.mem.size</name>
   <value>1024Mb</value>
@@ -273,6 +278,11 @@
   <value>binary</value>
 </property>
 
+<property>
+  <name>hive.stats.fetch.column.stats</name>
+  <value>true</value>
+</property>
+
 <property>
   <name>hive.support.concurrency</name>
   <value>true</value>
@@ -283,6 +293,11 @@
   <value>true</value>
 </property>
 
+<property>
+  <name>hive.tez.bucket.pruning</name>
+  <value>true</value>
+</property>
+
 <property>
   <name>hive.txn.manager</name>
   <value>org.apache.hadoop.hive.ql.lockmgr.DbTxnManager</value>
@@ -313,31 +328,6 @@
 
 <!-- Correctness -->
 
-<property>
-  <name>hive.optimize.shared.work.dppunion</name>
-  <value>false</value>
-</property>
-
-<property>
-  <name>hive.optimize.shared.work.dppunion.merge.eventops</name>
-  <value>false</value>
-</property>
-
-<property>
-  <name>hive.optimize.shared.work.downstream.merge</name>
-  <value>false</value>
-</property>
-
-<property>
-  <name>hive.optimize.shared.work.parallel.edge.support</name>
-  <value>false</value>
-</property>
-
-<property>
-  <name>hive.optimize.shared.work.merge.ts.schema</name>
-  <value>false</value>
-</property>
-
 <property>
   <name>hive.optimize.cte.materialize.threshold</name>
   <value>-1</value>
@@ -489,11 +479,6 @@
   <value>true</value>
 </property>
 
-<property>
-  <name>hive.llap.io.etl.skip.format</name>
-  <value>none</value>
-</property>
-
 <!-- MR3 -->
 
 <property>
@@ -526,11 +511,7 @@
     
 <property>
   <name>hive.mr3.aux.jars</name>
-  <value>hive-llap-common-4.0.0.jar,hive-llap-server-4.0.0.jar,hive-llap-tez-4.0.0.jar,hive-iceberg-handler-4.0.0.jar,log4j-1.2-api-2.18.0.jar,orc-core-2.0.3.jar,orc-format-1.0.0.jar,orc-shims-2.0.3.jar,orc-tools-2.0.3.jar</value>
-  <description>
-    Include Iceberg jar, even if mr3.am.permit.custom.user.class is set to true,
-    because IcebergInputFormat may use URLClassLoader.
-  </description>
+  <value>hive-llap-common-3.1.3.jar,hive-llap-server-3.1.3.jar,hive-llap-tez-3.1.3.jar</value>
 </property>
 
 <property>
diff --git a/hadoop/env.sh b/hadoop/env.sh
index 93adce9..f84abd8 100755
--- a/hadoop/env.sh
+++ b/hadoop/env.sh
@@ -201,7 +201,7 @@ MR3_REV=2.0
 TEZ_REV=0.9.1.mr3.${MR3_REV}
 
 # Hive-MR3 revision number
-HIVE_REV=4.0.0
+HIVE_REV=3.1.3
 
 #
 # Step 10. High availability (optional)
diff --git a/helm/hive/values.yaml b/helm/hive/values.yaml
index f444d3e..2447d93 100644
--- a/helm/hive/values.yaml
+++ b/helm/hive/values.yaml
@@ -25,8 +25,8 @@ name:
   persistentVolumeClaim: workdir-pvc
 
 docker:
-  image: mr3project/hive:4.0.0.mr3.2.3
-  containerWorkerImage: mr3project/hive:4.0.0.mr3.2.3
+  image: mr3project/hive:3.1.3.mr3.2.3
+  containerWorkerImage: mr3project/hive:3.1.3.mr3.2.3
   # do not use a composite name like hive@RED, hive/red0@RED
   user: hive
   imagePullPolicy: IfNotPresent
diff --git a/kubernetes/conf/hive-site.xml b/kubernetes/conf/hive-site.xml
index 67d7fce..2183671 100644
--- a/kubernetes/conf/hive-site.xml
+++ b/kubernetes/conf/hive-site.xml
@@ -60,11 +60,6 @@
   <value>true</value>
 </property>
 
-<property>
-  <name>hive.compactor.cleaner.on</name>
-  <value>false</value>
-</property>
-
 <property>
   <name>hive.compactor.initiator.on</name>
   <value>false</value>
@@ -217,11 +212,21 @@
   <value>true</value>
 </property>
 
+<property>
+  <name>hive.optimize.index.filter</name>
+  <value>true</value>
+</property>
+
 <property>
   <name>hive.optimize.metadataonly</name>
   <value>true</value>
 </property>
 
+<property>
+  <name>hive.optimize.sort.dynamic.partition</name>
+  <value>true</value>
+</property>
+
 <property>
   <name>hive.orc.cache.stripe.details.mem.size</name>
   <value>1024Mb</value>
@@ -247,6 +252,11 @@
   <value>all</value>
 </property>
 
+<property>
+  <name>hive.stats.fetch.column.stats</name>
+  <value>true</value>
+</property>
+
 <property>
   <name>hive.support.concurrency</name>
   <value>true</value>
@@ -257,6 +267,11 @@
   <value>true</value>
 </property>
 
+<property>
+  <name>hive.tez.bucket.pruning</name>
+  <value>true</value>
+</property>
+
 <property>
   <name>hive.txn.manager</name>
   <value>org.apache.hadoop.hive.ql.lockmgr.DbTxnManager</value>
@@ -287,31 +302,6 @@
 
 <!-- Correctness -->
 
-<property>
-  <name>hive.optimize.shared.work.dppunion</name>
-  <value>false</value>
-</property>
-
-<property>
-  <name>hive.optimize.shared.work.dppunion.merge.eventops</name>
-  <value>false</value>
-</property>
-
-<property>
-  <name>hive.optimize.shared.work.downstream.merge</name>
-  <value>false</value>
-</property>
-
-<property>
-  <name>hive.optimize.shared.work.parallel.edge.support</name>
-  <value>false</value>
-</property>
-
-<property>
-  <name>hive.optimize.shared.work.merge.ts.schema</name>
-  <value>false</value>
-</property>
-
 <property>
   <name>hive.optimize.cte.materialize.threshold</name>
   <value>-1</value>
@@ -524,11 +514,6 @@
   <value>true</value>
 </property>
 
-<property>
-  <name>hive.llap.io.etl.skip.format</name>
-  <value>none</value>
-</property>
-
 <!-- MR3 -->
 
 <property>
diff --git a/kubernetes/env.sh b/kubernetes/env.sh
index 241474b..f62b853 100755
--- a/kubernetes/env.sh
+++ b/kubernetes/env.sh
@@ -51,7 +51,7 @@ CREATE_SERVICE_ACCOUNTS=true
 # Step 1. Docker images
 #
 
-DOCKER_HIVE_IMG=${DOCKER_HIVE_IMG:-mr3project/hive:4.0.0.mr3.2.3}
+DOCKER_HIVE_IMG=${DOCKER_HIVE_IMG:-mr3project/hive:3.1.3.mr3.2.3}
 DOCKER_HIVE_WORKER_IMG=$DOCKER_HIVE_IMG
 
 # do not use a composite name like hive@RED, hive/red0@RED (which results in NPE in ContainerWorker)
diff --git a/kubernetes/yaml/hive.yaml b/kubernetes/yaml/hive.yaml
index 9a53a17..57b0c93 100644
--- a/kubernetes/yaml/hive.yaml
+++ b/kubernetes/yaml/hive.yaml
@@ -34,7 +34,7 @@ spec:
                 matchLabels:
                   hivemr3_app: metastore
       containers:
-      - image: mr3project/hive:4.0.0.mr3.2.3
+      - image: mr3project/hive:3.1.3.mr3.2.3
         command: ["/opt/mr3-run/hive/hiveserver2-service.sh"]
         args: ["start", "--kubernetes"]
         imagePullPolicy: Always
diff --git a/kubernetes/yaml/metastore.yaml b/kubernetes/yaml/metastore.yaml
index 0c8554c..4ab4806 100644
--- a/kubernetes/yaml/metastore.yaml
+++ b/kubernetes/yaml/metastore.yaml
@@ -43,7 +43,7 @@ spec:
         hostnames:
         - "red0"
       containers:
-      - image: mr3project/hive:4.0.0.mr3.2.3
+      - image: mr3project/hive:3.1.3.mr3.2.3
         command: ["/opt/mr3-run/hive/metastore-service.sh"]
         args: ["start", "--kubernetes"]
         imagePullPolicy: Always
diff --git a/standalone/conf/hive-site.xml b/standalone/conf/hive-site.xml
index 378da6d..b8d5c03 100644
--- a/standalone/conf/hive-site.xml
+++ b/standalone/conf/hive-site.xml
@@ -60,11 +60,6 @@
   <value>true</value>
 </property>
 
-<property>
-  <name>hive.compactor.cleaner.on</name>
-  <value>false</value>
-</property>
-
 <property>
   <name>hive.compactor.initiator.on</name>
   <value>false</value>
@@ -217,11 +212,21 @@
   <value>true</value>
 </property>
 
+<property>
+  <name>hive.optimize.index.filter</name>
+  <value>true</value>
+</property>
+
 <property>
   <name>hive.optimize.metadataonly</name>
   <value>true</value>
 </property>
 
+<property>
+  <name>hive.optimize.sort.dynamic.partition</name>
+  <value>true</value>
+</property>
+
 <property>
   <name>hive.orc.cache.stripe.details.mem.size</name>
   <value>1024Mb</value>
@@ -247,6 +252,11 @@
   <value>all</value>
 </property>
 
+<property>
+  <name>hive.stats.fetch.column.stats</name>
+  <value>true</value>
+</property>
+
 <property>
   <name>hive.support.concurrency</name>
   <value>true</value>
@@ -257,6 +267,11 @@
   <value>true</value>
 </property>
 
+<property>
+  <name>hive.tez.bucket.pruning</name>
+  <value>true</value>
+</property>
+
 <property>
   <name>hive.txn.manager</name>
   <value>org.apache.hadoop.hive.ql.lockmgr.DbTxnManager</value>
@@ -287,31 +302,6 @@
 
 <!-- Correctness -->
 
-<property>
-  <name>hive.optimize.shared.work.dppunion</name>
-  <value>false</value>
-</property>
-
-<property>
-  <name>hive.optimize.shared.work.dppunion.merge.eventops</name>
-  <value>false</value>
-</property>
-
-<property>
-  <name>hive.optimize.shared.work.downstream.merge</name>
-  <value>false</value>
-</property>
-
-<property>
-  <name>hive.optimize.shared.work.parallel.edge.support</name>
-  <value>false</value>
-</property>
-
-<property>
-  <name>hive.optimize.shared.work.merge.ts.schema</name>
-  <value>false</value>
-</property>
-
 <property>
   <name>hive.optimize.cte.materialize.threshold</name>
   <value>-1</value>
@@ -523,11 +513,6 @@
   <value>true</value>
 </property>
 
-<property>
-  <name>hive.llap.io.etl.skip.format</name>
-  <value>none</value>
-</property>
-
 <!-- MR3 -->
 
 <property>
